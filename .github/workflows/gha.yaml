
name: GitHub Actions Demo
run-name: ${{ github.actor }} is testing out GitHub Actions ðŸš€
on: [push]
jobs:
  Explore-GitHub-Actions:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code with submodules
        uses: actions/checkout@v3
        with:
          submodules: true

      - name: Wake up apt
        run: apt update

      - name: Cache apt dependencies
        uses: actions/cache@v2
        with:
          path: /tmp/apt-cache
          key: ${{ runner.os }}-apt-cache-${{ hashFiles('**/package.json') }}
          restore-keys: |
            ${{ runner.os }}-apt-cache-

      - name: Install dependencies
        run: apt install -y podman

      # TODO: I think this has gotta be dumb, surely we can just have GHA run
      # the container directly.
      - name: Run the container
        run: podman run --rm --mount=type=bind,source=${{ github.workspace }},destination=/src kgha /src/run.sh